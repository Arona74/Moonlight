improved some fabric code
improved some error handling and logging